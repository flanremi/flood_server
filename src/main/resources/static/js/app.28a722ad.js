(function(){"use strict";var t={7485:function(t,e,a){var o=a(9242),l=a(2219),i=(a(4415),a(3396));function n(t,e,a,o,l,n){const s=(0,i.up)("HelloWorld");return(0,i.wg)(),(0,i.j4)(s)}const s={class:"data_bodey"},r=(0,i.uE)('<div class="index_nav"><ul style="height:30px;margin-bottom:0px;"></ul><div class="total_chose_box" style="display:none;"><div style="height:32px;"></div><span class="chose_tltle">请选择年份：</span><select class="year_chose"><option>2017</option><option>2016</option><option>2015</option><option>2014</option><option>2013</option><option>2012</option></select><span class="chose_tltle">请输入月份：</span><input class="chose_text_in"><span class="chose_tltle">请选择区域：</span><select class="year_chose"><option> 成都市</option><option>自贡市</option><option>攀枝花市</option><option>泸州市</option><option>德阳市</option><option>绵阳市</option><option>广元市</option><option>遂宁市</option><option>内江市</option><option>乐山市</option><option>南充市</option><option>宜宾市</option><option>广安市</option><option>达州市</option><option>巴中市</option><option>雅安市</option><option>眉山市</option><option>资阳市</option><option>阿坝州</option><option>甘孜州</option><option>凉山州</option></select><button class="chose_enter">确定</button></div><div class="clear"></div></div>',1),c={class:"index_tabs"},p={class:"inner",style:{height:"109%"}};function d(t,e,a,o,l,n){const d=(0,i.up)("StreamScreen"),h=(0,i.up)("LeftMap");return(0,i.wg)(),(0,i.iD)("div",s,[r,(0,i._)("div",c,[(0,i._)("div",p,[(0,i.Wm)(d,{listData:l.listData},null,8,["listData"]),(0,i.Wm)(h,{listData:l.listData},null,8,["listData"])])])])}a(7658);const h={class:"left_cage"},u={class:"dataAllBorder01 cage_cl",style:{"margin-top":"9% !important",height:"50%"}},f={ref:"player1",class:"dataAllBorder02 video_cage",autoplay:"autoplay",preload:"auto",controls:"controls"},g={class:"dataAllBorder01 cage_cl",style:{"margin-top":"1.5% !important",height:"45%"}},m={class:"dataAllBorder02 video_cage"},_={ref:"player2",class:"video_around video_around_chose",muted:"",autoplay:"autoplay",preload:"auto",controls:"controls"},v={ref:"player3",class:"video_around video_around_chose",muted:"",autoplay:"autoplay",preload:"auto",controls:"controls"},y={ref:"player4",class:"video_around video_around_chose",muted:"",autoplay:"autoplay",preload:"auto",controls:"controls"},b={ref:"player5",class:"video_around video_around_chose",muted:"",autoplay:"autoplay",preload:"auto",controls:"controls"};function L(t,e,a,o,l,n){return(0,i.wg)(),(0,i.iD)("div",h,[(0,i._)("div",u,[(0,i._)("video",f,null,512)]),(0,i._)("div",g,[(0,i._)("div",m,[(0,i._)("video",_,null,512),(0,i._)("video",v,null,512),(0,i._)("video",y,null,512),(0,i._)("video",b,null,512)])])])}var w=a(4870),D=a(2747),x=a.n(D),k={name:"StreamScreen",props:{listData:(0,w.iH)()},setup(){const t=(0,i.f3)("camera_list_click_code"),e=(0,i.f3)("global"),a=(0,w.iH)(),o=(0,w.iH)(),l=(0,w.iH)(),n=(0,w.iH)(),s=(0,w.iH)(),r=(0,w.iH)([]),c=(0,w.iH)(["","","","",""]);return{camera_list_click_code:t,global:e,player1:a,player2:o,player3:l,player4:n,player5:s,streams:c,flvPlayers:r,oldStr:["","","","",""],target:["","","","",""]}},mounted(){let t=this;setTimeout(this.init,3e3),(0,i.YP)((()=>this.camera_list_click_code),(function(e){t.destroy();for(let a=0;a<t.listData.length;a++){let o=t.listData[a];if(o.code==e){t.streams.length=0;for(let e=0;e<5;e++){let o=t.listData[(a+e)%t.listData.length];t.target[e]=o.stream;let l=o.stream.split("_");t.global.axios.post("/get_stream",{channelId:l[0],deviceId:l[1]}).then((function(a){200==a.data.code?o.stream==t.target[e]&&(t.streams[e]=a.data.data.flv):console.log(a.data.code+"_"+a.data.desc)})).catch((function(t){console.log(t)}))}}}})),(0,i.YP)((()=>this.streams),(function(e){console.log(e),console.log(t.oldStr);for(let a=0;a<t.oldStr.length;a++)t.oldStr[a]!=e[a]&&(t.play(e[a],a),t.oldStr[a]=e[a])}),{deep:!0})},methods:{init(){let t=this;if(null!=this.listData&&this.listData.length>0){this.streams.length=0;for(let e=0;e<5;e++){let a=this.listData[e%this.listData.length],o=a.stream.split("_");console.log(o),this.global.axios.post("/get_stream",{channelId:o[0],deviceId:o[1]}).then((function(a){200==a.data.code?(console.log(t.streams),t.streams[e]=a.data.data.flv):console.log(a.data.code+"_"+a.data.desc)})).catch((function(t){console.log(t)}))}}},play(t,e){console.log(t,e);let a=[this.player1,this.player2,this.player3,this.player4,this.player5];if(x().isSupported()){let o=this;o.flvPlayers[e]=x().createPlayer({type:"flv",isLive:!0,url:t}),o.flvPlayers[e].attachMediaElement(a[e]),o.flvPlayers[e].load(),o.flvPlayers[e].play()}},destroy(){for(let t=0;t<this.flvPlayers.length;t++)null!=this.flvPlayers[t]&&(this.flvPlayers[t].pause(),this.flvPlayers[t].unload(),this.flvPlayers[t].detachMediaElement(),this.flvPlayers[t].destroy(),this.flvPlayers[t]=null)}}},M=a(89);const H=(0,M.Z)(k,[["render",L]]);var A=H;const P={class:"center_cage"},B={class:"dataAllBorder01 cage_cl",style:{"margin-top":"3.5% !important",height:"62.7%",position:"relative"}},C={class:"dataAllBorder02",style:{position:"relative",overflow:"hidden"}},E=(0,i._)("div",{class:"map_title_box",style:{height:"6%"}},[(0,i._)("div",{class:"map_title_innerbox"},[(0,i._)("div",{class:"map_title"},"秀洲区易涝点监测地图")])],-1),S={key:0,class:"map"},W=(0,i._)("iframe",{width:"100%",height:"100%",allowfullscreen:"",src:"https://experience.arcgis.com/experience/78a8e9b9b9a94fc290d9ebcd13876fc0/"},null,-1),J=[W],O=(0,i._)("div",{class:"map",id:"container"},null,-1);function j(t,e,a,o,l,n){const s=(0,i.up)("el-switch"),r=(0,i.up)("CameraList");return(0,i.wg)(),(0,i.iD)("div",P,[(0,i._)("div",B,[(0,i._)("div",C,[E,(0,i.Wm)(s,{modelValue:o.showMap,"onUpdate:modelValue":e[0]||(e[0]=t=>o.showMap=t),class:"ml-2","inline-prompt":"",style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#77aebb",float:"right","margin-right":"10px","padding-left":"5px","padding-right":"5px"},"active-text":" 三维地图 ","inactive-text":" 二维地图 "},null,8,["modelValue"]),o.showMap?((0,i.wg)(),(0,i.iD)("div",S,J)):(0,i.kq)("",!0),O])]),(0,i.Wm)(r,{listData:a.listData,map:o.map},null,8,["listData","map"])])}var Z=a(7634),F=a.n(Z);const Y={class:"dataAllBorder01 cage_cl",style:{"margin-top":"0.6% !important",height:"32.1%"}},I={class:"dataAllBorder02",id:"map_title_innerbox"},T=(0,i._)("div",{class:"map_title_box"},[(0,i._)("div",{class:"map_title_innerbox"},[(0,i._)("div",{class:"map_titl",style:{color:"#FFFFFF","padding-left":"10px","padding-top":"3px"}},"摄像头信息列表")]),(0,i._)("div")],-1);function R(t,e,a,o,l,n){const s=(0,i.up)("el-table-column"),r=(0,i.up)("el-table");return(0,i.wg)(),(0,i.iD)("div",Y,[(0,i._)("div",I,[T,(0,i.Wm)(r,{data:o.tableData,style:{width:"100%",height:"85%"},"cell-style":{textAlign:"center"},"header-cell-style":{"text-align":"center"},onRowClick:n.rowClick},{default:(0,i.w5)((()=>[(0,i.Wm)(s,{fixed:"",prop:"code",label:"编号",width:"180"}),(0,i.Wm)(s,{prop:"alert_lvl",label:"风险等级",width:"100"}),(0,i.Wm)(s,{prop:"address",label:"地址"})])),_:1},8,["data","onRowClick"])])])}var V={name:"CameraList",props:{listData:(0,w.iH)(),map:null},setup(){let t=(0,w.iH)([]),e=(0,w.iH)(0),a=(0,w.iH)(),o=(0,i.f3)("camera_list_click_code");return{tableData:t,pos:e,code:a,camera_list_click_code:o}},mounted(){let t=this;(0,i.YP)((()=>this.listData),(function(e){t.tableData.length=0;for(let a=0;a<e.length;a++)t.tableData.push((0,w.qj)({code:e[a].code,alert_lvl:e[a].alertLevel>1?"有涝情":"无涝情",address:e[a].address}))}),{deep:!0})},methods:{rowClick(t){let e=this;this.listData.forEach((function(a){a.code==t.code&&(e.camera_list_click_code=t.code)}))}}};const q=(0,M.Z)(V,[["render",R]]);var z=q,U={name:"LeftMap",components:{CameraList:z},props:{listData:(0,w.iH)()},setup(){const t=(0,i.f3)("global");let e=(0,i.f3)("camera_list_click_code");const a=(0,i.f3)("leftLng"),o=(0,i.f3)("leftLat"),l=(0,i.f3)("rightLat"),n=(0,i.f3)("rightLng");return{map:null,heatmap:null,AMap:null,global:t,markers:(0,w.iH)([]),heaters:(0,w.iH)([]),camera_list_click_code:e,rightLat:l,rightLng:n,leftLat:o,leftLng:a,showMap:(0,w.iH)(!1)}},mounted(){this.initMap();let t=this;(0,i.YP)((()=>this.camera_list_click_code),(function(e){t.listData.forEach((function(a){a.code==e&&(console.log(a),t.map.setCenter([a.lng,a.lat]))}))})),(0,i.YP)((()=>this.listData),(function(e){t.heaters.length=0,t.markers.forEach((function(e){t.map.remove(e)})),t.markers.length=0;for(let a=0;a<e.length;a++){let o,l=e[a];o=5==l.alertLevel?new t.AMap.Marker({position:new t.AMap.LngLat(l.lng,l.lat),title:l.code+"_"+l.address,icon:new t.AMap.Icon({image:"https://webapi.amap.com/theme/v1.3/markers/n/mark_r.png"})}):new t.AMap.Marker({position:new t.AMap.LngLat(l.lng,l.lat),title:l.code+"_"+l.address}),o.on("click",t.onClick),t.map.add(o),t.markers.push(o)}}),{deep:!0})},methods:{replaceMap(){this.showMap=!this.showMap},initMap(){let t=this;F().load({key:"12e81f070a0a6b062a8caf827347b19b",version:"2.0",resizeEnable:!0,plugins:["AMap.ToolBar","AMap.Scale","AMap.Geolocation"]}).then((e=>{t.AMap=e,t.map=new e.Map("container",{viewMode:"2D",zoom:18,center:[120.691131,30.765771],animateEnable:!1}),t.map.on("moveend",t.onMove)})).catch((t=>{console.log(t)}))},onClick(t){let e=t.target.getTitle().split("_")[0];this.camera_list_click_code=e},onMove(){(Math.abs(this.map.getBounds().northEast.lat-this.rightLat)>.001||Math.abs(this.map.getBounds().northEast.lng-this.rightLng)>8e-4)&&(this.rightLat=this.map.getBounds().northEast.lat,this.rightLng=this.map.getBounds().northEast.lng,this.leftLat=this.map.getBounds().southWest.lat,this.leftLng=this.map.getBounds().southWest.lng)}}};const G=(0,M.Z)(U,[["render",j]]);var K=G,N={data(){const t=(0,i.f3)("global");let e=(0,w.iH)();(0,i.JJ)("camera_list_click_code",e);let a=(0,w.iH)(0),o=(0,w.iH)(0),l=(0,w.iH)(0),n=(0,w.iH)(0);(0,i.JJ)("rightLat",a),(0,i.JJ)("rightLng",o),(0,i.JJ)("leftLat",l),(0,i.JJ)("leftLng",n);const s=[n,l,a,o];return{global:t,listData:(0,w.iH)([]),leftLng:n,leftLat:l,rightLat:a,rightLng:o,range:s}},name:"HelloWorld",components:{LeftMap:K,StreamScreen:A},mounted(){let t=this;(0,i.YP)((()=>t.leftLng),(()=>{t.refreshList()}),{deep:!0})},methods:{refreshList(){let t=this;t.global.axios.post("/get_camera_list",{leftLat:t.leftLat,leftLng:t.leftLng,rightLat:t.rightLat,rightLng:t.rightLng}).then((function(e){t.listData.length=0,console.log(e),e.data.data.forEach((function(e){t.listData.push(e)}))})).catch((function(t){console.log(t)}))}}};const Q=(0,M.Z)(N,[["render",d]]);var X=Q,$={name:"App",components:{HelloWorld:X}};const tt=(0,M.Z)($,[["render",n]]);var et=tt,at=a(4161);window._AMapSecurityConfig={securityJsCode:"a7fdf5bb3762d44534fb96585ec2ca75"},at.Z.defaults.baseURL="http://127.0.0.1:9898";const ot=(0,o.ri)(et);ot.provide("global",{axios:at.Z}),ot.use(l.Z),ot.mount("#app")}},e={};function a(o){var l=e[o];if(void 0!==l)return l.exports;var i=e[o]={exports:{}};return t[o].call(i.exports,i,i.exports,a),i.exports}a.m=t,function(){var t=[];a.O=function(e,o,l,i){if(!o){var n=1/0;for(p=0;p<t.length;p++){o=t[p][0],l=t[p][1],i=t[p][2];for(var s=!0,r=0;r<o.length;r++)(!1&i||n>=i)&&Object.keys(a.O).every((function(t){return a.O[t](o[r])}))?o.splice(r--,1):(s=!1,i<n&&(n=i));if(s){t.splice(p--,1);var c=l();void 0!==c&&(e=c)}}return e}i=i||0;for(var p=t.length;p>0&&t[p-1][2]>i;p--)t[p]=t[p-1];t[p]=[o,l,i]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){a.d=function(t,e){for(var o in e)a.o(e,o)&&!a.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};a.O.j=function(e){return 0===t[e]};var e=function(e,o){var l,i,n=o[0],s=o[1],r=o[2],c=0;if(n.some((function(e){return 0!==t[e]}))){for(l in s)a.o(s,l)&&(a.m[l]=s[l]);if(r)var p=r(a)}for(e&&e(o);c<n.length;c++)i=n[c],a.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return a.O(p)},o=self["webpackChunkjiaxing_flood"]=self["webpackChunkjiaxing_flood"]||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))}();var o=a.O(void 0,[998],(function(){return a(7485)}));o=a.O(o)})();
//# sourceMappingURL=app.28a722ad.js.map